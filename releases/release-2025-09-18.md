# Release 2025-09-18

Bu sürüm; kimlik doğrulama akışı, sayfa koruma (middleware + SSR), callback sayfası UI/UX iyileştirmeleri, ve favicon düzeltmesini içerir.

## Özet
- Callback sayfası DarkVeil arkaplanı ve shadcn kart ile yeniden tasarlandı, tüm içerik merkezde.
- Yeşil tik sola yatık ve ortalı; hiyerarşi, spacing ve responsive iyileştirildi.
- Buton davranışları netleştirildi: turuncu “Close this page”, ikincil “Continue here”.
- Giriş sonrası Dashboard Shell’in manuel yenilemeye gerek kalmadan gelmesi sağlandı.
- Tüm app sayfaları (root `/` ve `/auth/*` hariç) korunuyor; middleware ve SSR guard’lar güncellendi.
- Vercel default favicon yerine proje ikonunuz üretildi ve kullanılıyor.

## Değişiklikler

### Auth Callback UI
- Dosya: `src/app/auth/callback/page.tsx`
  - DarkVeil tam ekran sabit arkaplan olarak eklendi.
  - Kart daha geniş ve responsive (max-width arttırıldı), tüm içerik dikey/yatay ortalı.
  - Başlık (header) büyütüldü; yeşil tik sola yatık ve ortada konumlandırıldı.
  - Buton hiyerarşisi güncellendi: birincil (turuncu) “Close this page”, ikincil “Continue here”.
  - Spacing/hiyerarşi: açıklama metni butona yaklaştırıldı; alt boşluk optimize edildi.

### Giriş (Sign-in) sonrası Dashboard Shell yüklenmesi
- Dosya: `src/features/auth/components/supabase-signin-form.tsx`
  - `signInWithPassword` sonrası session’ın oluşmasını kısa bir bekleme ile doğrulama eklendi.
  - Önce SPA yönlendirme (`router.replace` + `router.refresh`), son çare olarak hard reload ile `/dashboard` garantilendi.

### Route Koruma (Middleware + SSR)
- Dosya: `middleware.ts`
  - Sadece `/` ve `/auth/*` public; diğer tüm yollar korumalı.
  - `/auth/callback` oturum varken de erişilebilir bırakıldı (başarılı ekran için).
  - Statik varlıklar ve `/api` bypass ediliyor; Supabase cookie yazımı korunuyor.
- SSR Guard eklenen/iyileştirilen layout’lar:
  - `src/app/chat/layout.tsx`
  - `src/app/contacts/layout.tsx`
  - `src/app/settings/layout.tsx`
  - `src/app/shipments/layout.tsx`
  - `src/app/profile/layout.tsx`
  - `src/app/nobledocs/layout.tsx`

### Favicon
- Script: `scripts/generate-favicon.mjs`
  - `public/logo_meta.svg` kaynağından çok boyutlu `public/favicon.ico` ve `public/favico.ico` üretimi.
  - Kullanılan paketler: `to-ico`, `sharp`.
- Metadata:
  - `src/app/layout.tsx` zaten `/favicon.ico` fallback içeriyor.

## Nasıl Doğrulanır
- E-posta doğrulama linkine tıklandığında: callback sayfasında DarkVeil arkaplanı ve kart görünür; “Close this page” sayfayı kapatmayı dener.
- Giriş yaptıktan sonra: `/dashboard` anında shell ile açılır; manuel yenilemeye gerek kalmaz.
- Oturum yokken korumalı sayfalara (örn. `/shipments`) girmek: middleware/SSR ile engellenir.
- Favicon: tarayıcıda site sekmesinde özelleştirilmiş ikon görünür (gerekirse hard refresh).

## Notlar
- `window.close()` sadece script ile açılan pencerelerde çalışır; e-posta linki aynı sekmede açıldıysa çağrı güvenli biçimde yok sayılır.
- DarkVeil görünürlüğü için tint/noise/scanline ayarları callback sayfasında parametrik olarak verildi; istenirse kolayca değiştirilebilir.
